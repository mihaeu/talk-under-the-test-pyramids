<!doctype html>
<html lang="en">

    <head>
        <meta charset="utf-8">

        <title>Testing under the Test Pyramid</title>

        <meta name="description" content="">
        <meta name="author" content="Michael Haeuslmann">

        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <link rel="stylesheet" href="css/reveal.css">
        <link rel="stylesheet" href="css/theme/simple.css" id="theme">

        <!-- Theme used for syntax highlighting of code -->
        <link rel="stylesheet" href="lib/css/zenburn.css">
        <!--<link rel="stylesheet" href="lib/css/vs.css">-->

        <style>
            @font-face {
                font-family: FiraCode;
                src: url(FiraCode-Regular.woff2);
            }

            .reveal section img, .reveal section blockquote {
                border: none;
                box-shadow: none;
                background: rgba(255, 255, 255, 0);
            }

            .dark code {
                font-family: FiraCode,serif;
                background: #3f3f3f;
                color: #dcdcdc;
            }

            :not(pre) code {
                padding: 1px;
                margin: 2px;
            }

            .center {
                text-align: center;
            }

            .reveal .smaller {
                font-size: 0.7em;
            }

            .reveal .fancy {
                color:#fff;
                font-weight: bolder;
                background: black;
                padding-bottom: 15px;
            }

        </style>

        <!-- Printing and PDF exports -->
        <script>
            var link = document.createElement( 'link' );
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
            document.getElementsByTagName( 'head' )[0].appendChild( link );
        </script>

        <!--[if lt IE 9]>
        <script src="lib/js/html5shiv.js"></script>
        <![endif]-->
    </head>

    <body>

        <div class="reveal dark">
            <div class="slides">

                <section data-background-image="img/pyramids.jpg" style="color:#fff;font-weight: bolder;-webkit-text-stroke: 2px black;" data-background-size="cover">
                    <h1 style="font-weight: bold;font-size: 3em;color:#fff;">
                        Testing Under the Test Pyramids
                    </h1>
                    <br>
                    <br>
                    <p style="-webkit-text-stroke: 1px black;">
                        Tech'n'Drinks Meetup (@myposterde)
                        <br>
                        Munich - 2018-02-28
                        <br>
                        Michael Haeuslmann (@michaelhaeu)
                    </p>
                </section>

                <section data-background-image="img/code.jpg" data-background-size="cover" style="background: rgba(255, 255, 255, 0.95)">
                    <h2>PHP Meetup (March 28th)</h2>
                    <hr>
                    <div>
                        <div style="float: left;">
                            <img src="img/victoria.jpg" style="border-radius: 50%;padding-left: 50px;width: 150px;">
                        </div>
                        <div style="float: left;">
                            <h3>Developing in Symfony 4</h3>
                            <h4>Victoria Quirante, limenius.com</h4>
                        </div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>


                    <div>
                        <div style="float: left;">
                            <img src="img/sebastian.jpeg" style="border-radius: 50%;padding-left: 50px;width: 150px;">
                        </div>
                        <div style="float: left;">
                            <h3>The Myth of Untestable Code</h3>
                            <h4>Sebastian Heuer, kartenmacherei.de</h4>
                        </div>
                    </div>
                    <div style="clear:both;"></div>

                    <hr>
                    <h3><strong>Chip</strong>, St.-Martin-Straße 66-68</h3>
                </section>

                <section data-background-image="img/tng-bg.png" data-background-size="cover">
                    <img src="img/tng.svg" width="800">
                    <br><br>
                    <br><br>
                    <br><br>
                </section>

                <section data-background-image="img/tng-facts-figures.png" data-background-size="contain">
                    <!-- SPEAKER NOTES -->
                    <aside class="notes">
                        <ul>
                            <li>many big customers</li>
                            <li>some small projects mostly ML related</li>
                        </ul>
                    </aside>
                </section>

                <section data-background-image="img/ipc-default-tng.png" data-background-size="cover">
                    <img src="img/tng-project-avatar.gif" width="800">
                </section>


                <section data-background-image="img/mikeonabike.png" data-background-size="contain">
                </section>

                <section data-background-image="img/pyramid-gizeh.jpeg" data-background-size="cover">
                    <h2 class="fancy">What do we test?</h2>
                </section>

                <section data-background-image="img/pyramid-gizeh.jpeg" data-background-size="cover">
                    <h2 class="fancy">Unit Tests</h2>
                </section>

                <section data-background-image="img/pyramid-gizeh.jpeg" data-background-size="cover">
                    <h2 class="fancy">Integration Tests</h2>
                </section>

                <section data-background-image="img/pyramid-gizeh.jpeg" data-background-size="cover">
                    <h2 class="fancy">E2E Tests</h2>
                </section>

                <section>
                    <h2>Why do we test?</h2>
                    <ul>
                        <li>input should be mapped to the correct output</li>
                    </ul>
                    <br>
                    <br>
                    <br>
                    <h3 class="fragment">Is that really it?</h3>
                </section>

                <section data-background-image="img/question.jpeg" data-background-size="cover">
                    <h2 class="fancy">What else do we test?</h2>
                </section>

                <section data-background-image="img/product.jpeg" data-background-size="cover">
                    <h2 class="fancy">What's important to us?</h2>
                </section>

                <section data-background-image="img/workers.jpeg" data-background-size="cover">
                    <h2 class="fancy">Do we test how we build our software?</h2>
                </section>

                <section data-background-image="img/documents.jpeg" data-background-size="cover">
                    <h2 class="fancy">How do we document our software?</h2>
                </section>

                <section data-background-image="img/backup.jpeg" data-background-size="cover">
                    <h2 class="fancy">How is our software delivered/backed-up?</h2>
                </section>

                <section data-background-image="img/architecture.jpeg" data-background-size="cover">
                    <h2 class="fancy">I. Architecture</h2>
                </section>

                <section data-background-image="img/software-baby.jpeg" data-background-size="cover">
                    <h2 class="fancy">How software is being made</h2>
                </section>

                <section>
                    <h2>Software Evolution</h2>
                    <h4 class="fragment">(aka "historisch gewachsen")</h4>
                    <img src="img/bacteria.gif" alt="" class="fragment">
                </section>

                <section data-background-image="img/hard-change.jpeg" data-background-size="cover">
                    <h2 class="fancy">Architecture is the stuff that's hard to change</h2>
                </section>

                <section>
                    <h2 class="fancy">Architecture is about reducing complexity</h2>
                </section>

                <section>
                    <h2 class="fancy">Architecture needs to be tested</h2>
                </section>

                <section data-background-image="img/diy.jpeg" data-background-size="cover">
                    <span style="font-size:3em;font-weight: bolder;background-color: rgba(255, 255, 255, 0.8);">Do it yourself?</span>
                    <br>
                    <span style="font-size:3em;font-weight: bolder;background-color: rgba(255, 255, 255, 0.8);">grep, AST, ...?</span>
                </section>

                <section data-background-image="img/structure101.png" data-background-size="contain">

                </section>

                <section data-background-image="img/tools.jpg" data-background-size="cover">
                    <span style="font-size:3em;font-weight: bolder;background-color: rgba(255, 255, 255, 0.8);">We need some tools!</span>
                </section>

                <section data-background-image="img/ipc-default-tng.png" data-background-size="cover">
                    <h2>dePHPend</h2>
                    <img src="img/dephpend.svg" alt="">
                    <h3>Visualizations & Assertions</h3>
                </section>

                <section data-background-image="img/ipc-default-tng.png" data-background-size="cover">
                    <img src="img/dephpend.svg" width="200">
                    <pre class="bash"><code data-trim data-noescape style="font-size: 0.6em;">
<span class="fragment highlight-current-green">λ wget http://phar.dephpend.com/dephpend.phar -O ~/bin/dephpend</span>
<span class="fragment highlight-current-green">λ dephpend --help
      _      _____  _    _ _____               _
     | |    |  __ \| |  | |  __ \             | |
   __| | ___| |__) | |__| | |__) |__ _ __   __| |
  / _` |/ _ \  ___/|  __  |  ___/ _ \ _ \ / _` |
 | (_| |  __/ |    | |  | | |  |  __/ | | | (_| |
  \__,_|\___|_|    |_|  |_|_|   \___|_| |_|\__,_| version 0.4

 Usage: ...
</span><span class="fragment highlight-current-green">λ dephpend <strong>text</strong> ~/workspace/dephpend/src
Mihaeu\PhpDependencies\Util\AbstractMap --> Mihaeu\PhpDependencies\Util\Collection
Mihaeu\PhpDependencies\Util\DI --> Mihaeu\PhpDependencies\Analyser\Analyser
...
</span>
                    </code></pre>
                </section>

                <section>
                    <h2>Visualizations</h2>
                    <img src="img/animated-architecture.gif" alt="">
                </section>

                <section data-background-image="img/ipc-default-tng.png" data-background-size="cover">
                    <img src="img/laravel-routing.png" alt="" width="300">
                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    <img src="img/dephpend.svg" width="200">
                    <pre class="fragment"><code class="php" data-trim data-noescape>
&lt;?php

$cmd = shell_exec('dephpend text src --no-classes');
$constraints = [
    'Model.* --> .*View',
    'View.*  --> .*Model',
];
$regex = '/('.implode(')|(', $constraints).')/x';

if (preg_match($regex, $cmd)) {
    echo 'Architecture violation'.PHP_EOL;
    exit(1);
}
                    </code></pre>
                </section>

                <section data-background-image="img/ipc-default-tng.png" data-background-size="cover">
                    <img src="img/dephpend.svg" alt="">
                    <br>
                    <br>
                    <code>https://github.com/mihaeu/dephpend</code>
                    <br>
                    <br>
                    <p>Whatever you end up using:</p>
                    <strong>Test your architecture!</strong>
                </section>

                <section data-background-image="img/ipc-default-tng.png" data-background-size="cover">
                    <img src="img/pdepend.png" alt="">
                    <h2>Metrics</h2>
                    <ul>
                        <li>number of dependencies, dependents</li>
                        <br>
                        <li>package size</li>
                        <br>
                        <li>abstractness of code</li>
                    </ul>
                </section>

                <section data-background-image="img/ipc-default-tng.png" data-background-size="cover">
                    <h2>pmd and PhpInspectionsEa to detect other architectural smells</h2>
                    <ul>
                        <li>gives you hints along the way</li>
                        <br>
                        <li>too many dependencies in a class</li>
                        <br>
                        <li>inheritance hierarchy too deep</li>
                        <br>
                        <li>static calls</li>
                        <br>
                    </ul>
                    <img src="img/pmd.png" style="float: right;">
                    <img src="img/inspections.png" style="float: right;">
                    <code>
                        https://phpmd.org/
                        https://github.com/kalessil/phpinspectionsea
                    </code>
                </section>

                <section>
                    <img src="img/archunit.png" alt="">
                    <img src="img/archunit.gif" alt="" class="fragment">
                </section>

                <section>
                    <h2>JavaScript implementation due in June(-ish)</h2>
                    <img src="img/clock.gif" alt="">
                </section>

                <section>
                    <h2 class="fancy">II. Documentation</h2>
                </section>

                <section>
                    <img src="img/confluence.png" width="700">
                </section>

                <section>
                    <img src="img/jira-gardener.png">
                </section>

                <section>
                    <h2 class="fancy">And there's an API ...</h2>
                </section>

                <section data-background-image="img/love.jpg" data-background-size="cover">
                    <code style="font-size: 3em;">Plaintext</code>
                </section>

                <section data-background-image="img/" data-background-size="cover">
                    <h2>Style Checks</h2>
                    <img src="img/write-good.png" width="600">
                    <h3>github.com/btford/write-good</h3>
                </section>

                <section data-background-image="img/" data-background-size="cover">
                    <h2>Markdown Linters</h2>
                    <img src="img/remark-lint.png" width="600">
                    <h3>github.com/remarkjs/remark-lint</h3>
                </section>

                <section data-background-image="img/" data-background-size="cover">
                    <h2>Build and Verify Glossaries</h2>
                    <pre width="300"><code class="bash">vi /usr/share/dict/project-glossary-english</code></pre>
                </section>

                <section>
                    <h2 class="fancy">III. Deployment/Backup</h2>
                </section>

                <section>
                    <blockqoute>
"If you don't test your backups properly there's an excellent chance you won't be able to recover them successfully when you need to."
                        <br>
                        <br>
                        - Rich Cook
                    </blockqoute>
                </section>

                <section>
                    <blockqoute>
                        48% of the test recoveries run by companies testing disaster recovery (DR) plans fail
                        <br>
                        <br>
                         - The Symantec Disaster Recovery Research 2007
                    </blockqoute>
                </section>

                <section data-background="#333">
                    <img src="img/phpbu.svg" width="600">
                </section>

                <section>
                    <h2 class="fancy">IV. Misc</h2>
                </section>

                <section data-background-image="img/" data-background-size="cover">
                    <h2>Stop bothering your CI</h2>
                    <h3>(and co-workers!)</h3>
                    <img src="img/hook.png" width="600">
                    <h4>github.com/sebastianfeldmann/captainhook</h4>
                </section>

                <section data-background-image="img/" data-background-size="cover">
                    <h2><img src="img/editorconfig.png" alt=""> Editorconfig</h2>
                    <pre><code class="ini">
# EditorConfig is awesome: http://EditorConfig.org

# top-most EditorConfig file
root = true

# Unix-style newlines with a newline ending every file
[*]
end_of_line = lf
insert_final_newline = true

# Matches multiple files with brace expansion notation
# Set default charset
[*.{js,py}]
charset = utf-8

# 4 space indentation
[*.py]
indent_style = space
indent_size = 4
                    </code></pre>
                    <h3>http://EditorConfig.org</h3>
                </section>

                <section data-background-image="img/" data-background-size="cover">
                    <h2>Test it!</h2>
                    <img src="img/editorconfigchecker.png" width="600">
                    <h3>github.com/editorconfig-checker/editorconfig-checker.javascript</h3>
                </section>

                <section>
                    <h1>Thanks!!!</h1>
                    <br>
                    <br>
                    <h3>@michaelhaeu</h3>
                    <br>
                    <img src="img/tng2.svg" width="200">
                    <br>
                    <br>
                    <p>Stock photos from <a href="pexels.com">pexels.com</a></p>
                </section>

                <section data-background-image="img/code.jpg" data-background-size="cover" style="background: rgba(255, 255, 255, 0.95)">
                    <h2>PHP Meetup (March 28th)</h2>
                    <hr>
                    <div>
                        <div style="float: left;">
                            <img src="img/victoria.jpg" style="border-radius: 50%;padding-left: 50px;width: 150px;">
                        </div>
                        <div style="float: left;">
                            <h3>Developing in Symfony 4</h3>
                            <h4>Victoria Quirante, limenius.com</h4>
                        </div>
                    </div>
                    <div style="clear:both;"></div>
                    <hr>


                    <div>
                        <div style="float: left;">
                            <img src="img/sebastian.jpeg" style="border-radius: 50%;padding-left: 50px;width: 150px;">
                        </div>
                        <div style="float: left;">
                            <h3>The Myth of Untestable Code</h3>
                            <h4>Sebastian Heuer, kartenmacherei.de</h4>
                        </div>
                    </div>
                    <div style="clear:both;"></div>

                    <hr>
                    <h3><strong>Chip</strong>, St.-Martin-Straße 66-68</h3>
                </section>

            </div>
        </div>

        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.js"></script>

        <script>

            // More info https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                progress: true,
                history: true,
                center: true,
                controls: false,

                transition: 'fade', // none/fade/slide/convex/concave/zoom

                // More info https://github.com/hakimel/reveal.js#dependencies
                dependencies: [
                    { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
                    { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: 'plugin/zoom-js/zoom.js', async: true },
                    { src: 'plugin/notes/notes.js', async: true }
                ]
            });

        </script>

    </body>
</html>
